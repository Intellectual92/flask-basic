# Chapter 정리

### 3장

- Flask는 `파이썬 웹 애플리케이션`을 구현할 때 사용되는 프레임워크이며, Django와 다르게 웹 애플리케이션을 구현할 때 꼭 필요한 기능만을 제공하는 프레임워크다. 그러므로 학습곡선이 비교적 낮다.

- 프레임워크는 특정 시스템을 구현하기 위해서 **공통적으로 요구되는 기능들과 구조를 재사용이 가능하도록 구현해 놓은 것**이다. Flask 같은 웹 프레임워크를 사용함으로써 개발자는 웹 시스템을 통해 제공하고자 하는 비즈니스 로직에만 집중할 수 있는 것이다.

- 프레임워크와 라이브러리의 차이점은, 라이브러리는 개발자가 자신의 코드 안에서 실행한다면 프레임워크는 프레임워크가 개발자의 코드를 실행하는 개념이다. 즉, 라이브러리는 개발자의 코드 안에 일부분으로 포함되어 개발자가 원하는 대로 사용이 가능하지만, 프레임 워크는 프레임워크가 제공하는 틀 안에서 개발자가 필요한 로직을 구현하는 차이가 있다.

- 파이썬 개발을 할 때에는 먼저 파이썬 가상 환경을 생성한 후 항상 활성화시킨 상태에서 개발, 실행, 테스트를 해야 한다. 파이썬 가상 환경을 생성하는 방법은 여러 가지가 있지만, 콘다를 사용하여 파이썬 개발 환경을 생성하는 것이 선호된다.

- 엔드포인트(endpoint)란 단순하게 설명하자면 API 서버가 제공하는 통신 채널 혹은 접점이라고 할 수 있다. 프론트엔드 서버 등의 클라이언트가 백엔드 API 서버와 통신할 때 엔드포인트에 접속하는 형태로 통신하게 된다. 각 엔드포인트는 고유의 URL 주소를 가지게 되며, 고유의 URL 주소를 통해 해당 엔드포인트에 접속할 수 있다.

- Flask에서는 일반적으로 `route 데코레이터`를 사용해서 함수들을 엔드포인트로 등록하는 방식이 사용된다. 즉, Flask에서 엔드포인트를 구현한다는 것은 결국 일반 함수를 구현하는 것과 마찬가지다. 그러므로 백엔드 API 개발도 구조적으로는 크게 어렵거나 복잡할 것이 없다. 해당 API가 제공하는 서비스, 즉 **비즈니스 로직을 구현하는 함수들을 개발하는 것이 백엔드 API에서 차지하는 가장 큰 부분**이 된다. 다시 한번 강조하고자 한다.

- 백엔드 API 개발 입문에서 중요한 것은 먼저 기본적인 개념을 먼저 잘 이해하고, 그러고 난 후 API 코드의 전체적인 구조에 대해서 이해하는 것이 핵심이라고 할 수 있다. API의 개념을 잘 이해해서 구조를 잘 잡고 나면 그다음은 필요한 비즈니스 로직을 함수를 통해 구현하기만 하면 된다. API 코드의 전체적인 구조가 일단 잡히면 그다음부터는 엔드포인트들, 즉 함수들을 구현하는 것이 개발의 대부분이다. 함수를 구현하는 것은 개념적이나 구조적으로는 어려울 것이 없다.

- API를 개발하기 위해 필수적인 기본 개념들 중 가장 중요한 것 하나가 바로 HTTP다. 왜냐하면 API는 기본적으로 HTTP 통신에 기반을 두고 있기 때문이다.

### 5장

- 데이터를 수정하는 기능의 엔드포인트는 `POST`를 사용한다.

- 데이터를 읽어 들이는 기능의 엔드포인트는 `GET`을 사용한다.

- POST 엔드포인트에 데이터를 전송할 때는 `body에 JSON 형식`으로 데이터를 전송한다.

- URL에 인자(Parameter)를 전송하고 싶을 때는 `<type:value>` 형식으로 URL을 구성한다. 예를 들어 int 값의 사용자 아이디를 URL에 포함시켜 받고 싶을 때는 다음과 같이 주소를 구성하면 된다. => /timeline/<int:user_id>

- 중복된 값이 없어야 하는 데이터라면 set을 사용하고, 순서나 순차가 중요하다면 list를 사용하자. 키와 값을 표현해야 하는 데이터의 경우는 딕셔너리를 사용하도록 하자.

### 6장

- 데이터베이스 시스템은 이름 그대로 데이터를 저장 및 보존하는 시스템이다. 데이터베이스에 저장되어 있는 데이터를 읽어들일 수 있으며, 새로운 데이터를 저장할 수도 있고, 기존의 데이터를 업데이트할수도 있다.

- 일반적으로 데이터베이스 시스템은 크게 2가지 종류로 분류된다. `관계형 데이터베이스 시스템`(RDBMS, Relational Database Management System) 그리고 "NoSQL"로 명칭되는 `비 관계형`(Non-relational) 데이터베이스다.

- 관계형 데이터베이스에서 테이블들의 상호 관련성 종류에는 다음의 3가지가 있다.

  - one to one
  - one to many
  - many to many

- 관계형 데이터베이스에서 `외부 키(foreign key)를 사용해서 테이블들을 연결하여 데이터 값의 중복을 최소화`하게 데이터를 구조화하는 프로세스를 **정규화(Normalization)**라 한다.

- 관계형 데이터베이스에서 **트랜잭션**은 일련의 작업들이 마치 하나의 작업처럼 취급되어서 `모두 다 성공`하거나 아니면 `모두 다 실패`하는 것을 말한다.

- SQL(Structure Query Language)은 MySQL 같은 관계형 데이터베이스에서 데이터를 읽거나 생성 및 수정하기 위해 사용하는 언어다.

  - `SELECT` 구문은 관계형 데이터베이스 시스템에서 데이터를 읽어 들일 때 사용하는 SQL 구문이다.
  - `INSERT` 구문은 데이터를 생성할 때 사용된다.
  - `UPDATE` 구문은 기존의 데이터를 수정할 때 사용한다.
  - `DELETE` 구문은 데이터를 삭제할 때 사용한다.
  - `JOIN` 구문은 여러 테이블을 연결할 때 사용한다.
  - 테이블 생성은 `CREATE TABLE` 구문으로 한다.

- sqlalchemy 라이브러리를 사용하여 파이썬 코드에서 데이터베이스에 연결하고 text 함수를 사용하여 실행할 SQL을 만든다.

- Flask가 `create_app`이라는 이름의 함수를 자동으로 `팩토리(factory) 함수로 인식`해서 해당 함수를 통해서 Flask를 실행시킨다.

### 7장

- 인증 절차는 대부분의 API들이 필요로 하는 기능이다.

- 인증 과정

1. 먼저 사용자 가입 절차를 진행해서 사용자의 `아이디와 비밀번호를 생성`해야 한다.
2. 가입한 사용자의 `아이디와 비밀번호(암호화)를 데이터베이스에 저장`한다.
3. 사용자가 로그인할 때 본인의 아이디와 비밀번호를 입력한다.
4. 사용자가 `입력한 비밀번호를 암호화`한 후, 그 값을 이미 이미 `암호화된 DB에 저장된 비밀번호와 비교`한다.
5. 비밀번호가 일치하면 로그인 성공이다.
6. 로그인에 성공하면 벡엔드 API 서버는 `access token을 프론트엔드 혹은 클라이언트에게 전송`한다.
7. 프론트엔드 서버는 로그인 성공 후 다음부터는 해당 `사용자의 access token을 첨부해 request를 서버에 전송`함으로써 매번 로그인하지 않아도 되게끔 한다.

- 일반적으로 사용자의 비밀번호는 절대 본래의 비밀번호 값 그대로 데이터베이스에 저장하지 않는다. (외부 or 내부에 데이터베이스가 노출될 위험 때문에)

- 사용자 비밀번호는 꼭 `단반향 해시 암호화`해서 저장해야 한다.(복호화 할 수 없음) 그리고 bcrypt와 같이 rainbow attact을 막아주는 단방향 암호 알고리즘을 사용하는 것이 더욱 안전하다.

- HTTP 통신은 stateless이므로 해당 통신 전에 인증 절차를 거치는 통신이 있었는지에 대해서 알 수 없다. 그러므로 `모든 HTTP 통신에 인증 여부 정보를 첨부`해야 한다. 이러한 것을 가능케 해주는 것이 `access token`이다.

- access token은 `JWT(JSON Web Token)을 사용해서 생성`될 수 있다. JWT는 이름 그대로 JSON 데이터를 token으로 변환하는 방식이다. JWT를 생성할 때 조심해야 할 점은 민감한 사용자의 개인정보는 포함시키지 말아야 한다는 것이다.

- 인증 절차를 엔드포인트들에 적용시키기 위해서 `decorator를 사용`할 수 있다.

### 8장

- 시스템을 테스트하는 방법에는 크게 3가지가 있다. (UI test, integration test, unit test)

- 전체 테스트 중 `UI test는 10%`, `integration test는 20%`, 그리고 나머지 `70%는 unit test`로 구성하는 것을 권장한다.

- 파이썬에서 unit test 구현을 도와주는 라이브러리 중 하나는 `pytest`다.

- test 파일의 이름은 `test_`로 시작해야 하며, 마찬가지로 test 함수도 `test_`로 시작되어야 한다.

- `pytest.fixture decorator`를 사용하여 test 함수에 필요한 인자들을 제공할 수 있다.

- `setup_function`과 `teardown_function`을 사용하여 각 `test 함수들이 실행되기 전에 필요한 test 데이터들을 생성`할 수 있고, 또한 각 test 함수들이 실행 종료된 후 test 데이터들을 삭제해 줄 수 있다.

- 각 test 함수들은 서로에게 영향받지 않고 독립적으로 실행되어야 하기 때문에 test 데이터들을 삭제해 주는 것이 중요하다.

- Flask의 test_client 함수를 통해 엔드포인트 함수들에 `가상의 HTTP 요청(request)을 보내고 응답(response)을 받을 수 있다.` 그러므로 test_client 함수를 사용해 unit test를 구현하면 unit test이지만 어느정도 integration test를 실행하는 효과도 볼 수 있다.
